From 1cd00c0a3a1b36e134772db3356c37b714aa3822 Mon Sep 17 00:00:00 2001
From: Pavel Sokolov <pavel.m.sokolov@gmail.com>
Date: Thu, 12 Feb 2015 14:00:01 +0100
Subject: [PATCH] Fixing removal of duplicated entries due to
 multicategorization

---
 modules/taxonomy/views_handler_argument_term_node_tid_depth.inc | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/modules/taxonomy/views_handler_argument_term_node_tid_depth.inc b/modules/taxonomy/views_handler_argument_term_node_tid_depth.inc
index 116a4de..0cf8ee1 100644
--- a/modules/taxonomy/views_handler_argument_term_node_tid_depth.inc
+++ b/modules/taxonomy/views_handler_argument_term_node_tid_depth.inc
@@ -132,6 +132,10 @@ class views_handler_argument_term_node_tid_depth extends views_handler_argument
 
     $subquery->condition($where);
     $this->query->add_where(0, "$this->table_alias.$this->real_field", $subquery, 'IN');
+
+    // Fixing removal of duplicated entries due to multi categorisation. Pavel Sokolov.
+    $this->query->add_field('taxonomy_index', 'tid');
+    $this->query->add_where(0, 'taxonomy_index.tid', $tids, $operator);
   }
 
   function title() {
-- 
1.9.3 (Apple Git-50)

