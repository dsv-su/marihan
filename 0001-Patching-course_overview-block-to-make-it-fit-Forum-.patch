From ebb4de75447826aa307d6b4e5d6f9f2745091b95 Mon Sep 17 00:00:00 2001
From: Pavel Sokolov <pavel.m.sokolov@gmail.com>
Date: Tue, 21 Jul 2015 12:37:57 +0300
Subject: [PATCH 1/1] Patching course_overview block to make it fit Forum
 instance

---
 blocks/course_overview/block_course_overview.php | 8 ++++++--
 blocks/moodleblock.class.php                     | 2 +-
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/blocks/course_overview/block_course_overview.php b/blocks/course_overview/block_course_overview.php
index ae244ef..c56af4f 100644
--- a/blocks/course_overview/block_course_overview.php
+++ b/blocks/course_overview/block_course_overview.php
@@ -39,7 +39,7 @@ class block_course_overview extends block_base {
      * Block initialization
      */
     public function init() {
-        $this->title   = get_string('pluginname', 'block_course_overview');
+        $this->title = get_string('modulenameplural', 'mod_forum');
     }
 
     /**
@@ -83,7 +83,7 @@ class block_course_overview extends block_base {
 
         // Number of sites to display.
         if ($this->page->user_is_editing() && empty($config->forcedefaultmaxcourses)) {
-            $this->content->text .= $renderer->editing_bar_head($totalcourses);
+            //$this->content->text .= $renderer->editing_bar_head($totalcourses);
         }
 
         if (empty($sortedcourses)) {
@@ -125,4 +125,8 @@ class block_course_overview extends block_base {
         $config = get_config('block_course_overview');
         return !empty($config->showwelcomearea);
     }
+
+    public function instance_can_be_collapsed() {
+        return false;
+    }
 }
diff --git a/blocks/moodleblock.class.php b/blocks/moodleblock.class.php
index f16b0bc..ec820ad 100644
--- a/blocks/moodleblock.class.php
+++ b/blocks/moodleblock.class.php
@@ -244,7 +244,7 @@ class block_base {
             $this->arialabel = $bc->arialabel;
         }
 
-        if ($this->page->user_is_editing()) {
+        if ($this->page->user_is_editing() && $this->name() !== 'course_overview') {
             $bc->controls = $this->page->blocks->edit_controls($this);
         } else {
             // we must not use is_empty on hidden blocks
-- 
2.3.2 (Apple Git-55)

